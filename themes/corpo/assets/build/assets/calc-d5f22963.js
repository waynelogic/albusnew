const b=n=>{if(!(n instanceof HTMLElement))return!1;const s={},i=["input","select","textarea"],o={hide:e=>e.style.setProperty("display","none"),show:e=>e.style.removeProperty("display"),enabled:e=>{i.includes(e.tagName.toLowerCase())?e.disabled=!1:e.querySelectorAll(i.join(",")).forEach(t=>t.disabled=!1)},disabled:e=>{i.includes(e.tagName.toLowerCase())?e.disabled=!0:e.querySelectorAll(i.join(",")).forEach(t=>t.disabled=!0)},empty:e=>{(i.includes(e.tagName.toLowerCase())?[e]:e.querySelectorAll(i.join(","))).forEach(c=>{["checkbox","radio","button","submit"].includes(c.type)||(c.value=""),["checkbox","radio"].includes(c.type)&&(c.checked=!1),c.dispatchEvent(new Event("change",{bubbles:!0}))})}};n.querySelectorAll("[data-trigger-field]").forEach(e=>{const t=e.dataset.triggerAction,c=e.dataset.triggerField,r=e.dataset.triggerCondition;t===void 0||c===void 0||r===void 0||(s[c]===void 0&&(s[c]=[]),s[c].push({el:e,action:t,condition:r}))});const a=({target:e})=>h(e),l=({action:e,condition:t,el:c},r)=>{const g=e=="show"?"hide":"show";o[r==t?e:g](c)},d=({action:e,condition:t,el:c},r)=>{const g=e=="enabled"?"disabled":"enabled";o[r==t?e:g](c)},u=(e,t)=>{["show","hide"].includes(e.action)&&l(e,t),["enabled","disabled"].includes(e.action)&&d(e,t),e.action=="empty"&&e.condition==t&&o.empty(e.el)},h=e=>{const t=["checkbox","radio"].includes(e.type)?e.checked?"checked":"unchecked":e.value;(s[e.name]||[]).forEach(r=>u(r,t))};return n.querySelectorAll(i.join(",")).forEach(e=>h(e)),n.addEventListener("input",a),n.addEventListener("change",a),()=>{console.log("clear triggers"),n.removeEventListener("input",a),n.removeEventListener("change",a)}};class f{constructor(s){this.calcArea=s,this.$totalPrice=this.calcArea.querySelector(".total-price"),this.basePrice=parseInt(this.calcArea.dataset.calcBaseprice),this.totalPrice=0,this.debounce=this.debounce(this.reload,1e3),this.init()}debounce(s,i,o){var a;return function(){var l=this,d=arguments,u=function(){a=null,o||s.apply(l,d)},h=o&&!a;clearTimeout(a),a=setTimeout(u,i),h&&s.apply(l,d)}}init(){b(this.calcArea),this.items=this.calcArea.querySelectorAll(".calc-item"),this.items.forEach(s=>{s.addEventListener("change",()=>{this.debounce()})}),this.count()}count(){let s=this.basePrice;this.items.forEach(i=>{i.checked&&(s+=parseInt(i.value))}),this.totalPrice=Intl.NumberFormat("ru-RU").format(s),this.$totalPrice.innerHTML=this.totalPrice}reload(){this.count(),this.flash("Стоимость заказа: "+this.totalPrice+" руб.")}flash(s,i="info",o=3){oc.flashMsg({text:s,class:i,interval:3})}}function p(n){new f(n)}export{p as default};
